<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" th:replace="~{layout :: layout(~{::title}, ~{::menu}, ~{::content})}">
<head>
    <title>Students - Manage Grades</title>
</head>
<body>
    <ul th:fragment="menu" class="nav flex-column">
        <li class="nav-item"><a class="nav-link" th:href="@{/teacher/dashboard}"><i class="bi bi-speedometer2"></i> Dashboard</a></li>
        <li class="nav-item"><a class="nav-link" th:href="@{/teacher/modules}"><i class="bi bi-book"></i> My Modules</a></li>
        <li class="nav-item"><a class="nav-link" th:href="@{/teacher/sessions}"><i class="bi bi-calendar3"></i> My Timetable</a></li>
        <li class="nav-item"><a class="nav-link active" th:href="@{/teacher/grades}"><i class="bi bi-clipboard-check"></i> Manage Grades</a></li>
    </ul>

    <div th:fragment="content">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a th:href="@{/teacher/grades}">Modules</a></li>
                <li class="breadcrumb-item active" aria-current="page" th:text="${module.name}">Module</li>
            </ol>
        </nav>

        <h1 class="mb-4">Enrolled Students</h1>
        <h5 class="text-muted mb-4" th:text="${module.name + ' - ' + module.program}">Module Info</h5>

        <div class="card">
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead>
                            <tr>
                                <th>Student</th>
                                <th>Email</th>
                                <th>Group</th>
                                <th>Final Grade</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="enrollment : ${enrollments}">
                                <td th:text="${enrollment.student.firstName + ' ' + enrollment.student.lastName}">Student Name</td>
                                <td th:text="${enrollment.student.user.email}">email@example.com</td>
                                <td th:text="${enrollment.student.group != null ? enrollment.student.group.name : 'N/A'}">Group A</td>
                                <td>
                                    <strong th:if="${enrollment.grade != null && enrollment.grade.finalGrade != null}" 
                                            th:text="${enrollment.grade.finalGrade}"
                                            th:classappend="${enrollment.grade.finalGrade >= 10 ? 'text-success' : 'text-danger'}">-</strong>
                                    <span th:if="${enrollment.grade == null || enrollment.grade.finalGrade == null}" class="text-muted">Not graded</span>
                                </td>
                                <td>
                                    <a th:href="@{/teacher/grades/edit/{enrollmentId}(enrollmentId=${enrollment.id})}" 
                                       class="btn btn-sm btn-primary">
                                        <i class="bi bi-pencil"></i> Edit Grade
                                    </a>
                                </td>
                            </tr>
                            <tr th:if="${#lists.isEmpty(enrollments)}">
                                <td colspan="5" class="text-center text-muted">No students enrolled</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
